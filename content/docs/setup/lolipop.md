---
title: ロリポップ！レンタルサーバーに PortalDotsをインストールする
description: ロリポップ！レンタルサーバーに PortalDotsをインストールする方法をご説明します。
---

<docs-alert type="info">
  このページでは、2021年5月末リリース予定の PortalDots 3 について説明しています。PortalDots 1 はさくらのレンタルサーバーでのみ動作します。
</docs-alert>

## 「ロリポップ！レンタルサーバー」で PortalDotsを利用する際の留意点

- 「ロリポップ！レンタルサーバー」では、利用料金の支払いにクレジットカード決済のほか、銀行振替やコンビニ決済が利用できます。
- 「お知らせ」の検索機能はロリポップ！レンタルサーバーでは利用できません。検索機能を利用したい場合、MySQL 5.7 以上に対応した他のレンタルサーバーの利用をご検討ください。

## このページで説明する内容

- FTP接続ソフトとしてCyberduckを使用する前提で説明します。
- レンタルサーバー申し込み時に決めるURLを、PortalDotsのURLとしてそのまま利用する前提で説明します。
    - 独自ドメインを利用したい場合や、1つのロリポップ！レンタルサーバーの契約で PortalDots以外のウェブサイトも設置したい場合のセットアップ方法は、このページでは説明しません。
- レンタルサーバー申し込み時に自動で作成されるメールアドレスを、PortalDotsから自動配信されるメールの差出人としてそのまま利用する前提で説明します。
    - PortalDotsから自動配信するメールの差出人のメールアドレスをカスタマイズしたい場合のセットアップ方法は、このページでは説明しません。
- PortalDotsは、学校から学生に対し発行されるメールアドレスの形式が「学籍番号@固定のドメイン」の場合のみ利用できます。
    - 例えば東京理科大学の場合は「固定のドメイン」が「ed.tus.ac.jp」となっており、利用可能です。「@」より前に任意の文字列を設定できる学校、または学生により「@」より後の文字列が異なる学校、「@」より前の文字列において、小文字・大文字の区別がある学校では PortalDotsは利用できません（将来的には、これらの学校でも利用できるようにする予定です）。

<docs-alert type="info">
  「@」より前に任意の文字列を設定できる学校でも、一応の利用は可能です。その場合、参加企画に対しては次のように説明してください : 「ウェブシステム上では『学籍番号』と表示されていますが、この入力欄には、学校発行メールアドレスの『@』より前の文字列を入力してください。」
</docs-alert>

## 1. ロリポップ！レンタルサーバーに申し込む（無料お試しあり）

※無料お試しは、お支払い方法の入力は不要です。

1. [ロリポップ！レンタルサーバー](https://lolipop.jp/)のウェブサイトにアクセスします
2. 「ご利用料金」ページへアクセスし、「ライト」プランの「10日間無料でお試し」をクリックします
    - PortalDotsの動作は、最低でも「ライト」プランの契約が必要です（エコノミープランでは動作しません）。
    - PortalDots以外のウェブサイトをロリポップ！レンタルサーバー上に設置することを検討している場合、複数のデータベースを利用できる「スタンダード」プラン以上の利用が向いているかもしれません。
3. 「ロリポップ！のドメイン」で、PortalDotsのURLを決めます
    - ロリポップ！レンタルサーバー上で PortalDots以外のウェブサイトの設置を検討している場合、学園祭実行委員会の英語名などをURLにすることをお勧めします（本ページでは複数ウェブサイトをロリポップ！レンタルサーバー上に設置する場合のPortalDotsインストール方法は説明しません）
4. 「パスワード」を決め、「連絡先メールアドレス」を入力します
    - 「ロリポップ！のドメイン」と「パスワード」は、「ロリポップ！ユーザー専用ページ」にログインする際に必要ですのでご留意ください。
5. 「SMS認証」や「お申し込み内容入力」など、ロリポップ！レンタルサーバー申し込みに必要な手続きを進めます
6. ロリポップ！レンタルサーバーへの申し込みが完了したら、次の「2. データベースを作成する」へ進みます

<docs-alert type="warning">
  パスワードの使い回しや複数人での共有は危険です。<br>PortalDots上ではユーザーの個人情報を多く扱うことになります。ロリポップ！レンタルサーバーのパスワードが漏洩すると、ユーザーの個人情報が流出する恐れがありますので、パスワードの取り扱いには十分ご注意ください。
</docs-alert>

## 2. データベースを作成する

PortalDots上に保存するデータ（ユーザー情報や参加企画情報など）は、データベース上に保存されます。PortalDotsのインストール前に、あらかじめデータベースを作成しておきます。

1. 「ロリポップ！ユーザー専用ページ」にログインします
    - ロリポップ！レンタルサーバーの申し込み時に入力した「ロリポップ！のドメイン」と「パスワード」でログインできます。
2. 画面左のメニューから「サーバーの管理・設定」を選び、「データベース」をクリックします
3. 「作成」ボタンをクリックします
4. 「データベース名」と「接続パスワード」は任意のものを設定します。ここで入力したデータベース名と接続パスワードは、PortalDotsをインストールする際に必要です。
5. 「作成」ボタンをクリックします。
6. データベース情報ページが表示されます。表示された「**サーバー**」「**データベース名**」「**ユーザー名**」「**パスワード**」を確認、メモします。
    - 「パスワード」は、「パスワード確認」ボタンをクリックすると表示されます。

<docs-alert type="warning">
  「接続パスワード」は、他の用途で利用していないパスワードを設定してください。このパスワードが漏洩すると、PortalDotsに保存されたユーザー情報が全て漏洩します。接続パスワードを忘れてしまった場合でも、ロリポップ！ユーザー専用ページ上で再度確認できますので、必ずランダムな文字列をパスワードとして設定してください。
</docs-alert>

## 3. メールサーバーを確認する

PortalDotsでは、ユーザーへメールを自動送信するために、ロリポップのメールサーバー情報が必要になります。PortalDotsからのメルマガの配信を予定していない場合でも、メールサーバーの設定は必須です。

1. 「ロリポップ！ユーザー専用ページ」にログインします
2. 画面左のメニューから「メール」を選び、「メール設定／ロリポップ！webメーラー」をクリックします
3. メールアドレス一覧表の「メール設定」の列にある「確認・変更」ボタンをクリックします
4. 「メール情報」にある「**メールアドレス**」「**SMTP メールサーバー** (smtp.lolipop.jp)」「**ポート番号**」「**メールアカウント**」「**メールパスワード**」を確認、メモします。これらの情報は、PortalDotsをインストールする際に必要です。
    - 「メールパスワード」は、「••••••••••」が表示されている箇所をクリックすると表示されます。

<docs-alert type="warning">
  「メールパスワード」が漏洩すると、第三者が PortalDots のシステムになりすましてメールを送信することが可能になります。必ずランダムな文字列をパスワードとして設定してください。
</docs-alert>

## 4. PortalDotsをサーバーにアップロードする

<docs-alert type="info">
  ブラウザ上で利用できる「ロリポップ！FTP」では PortalDotsをアップロードできません
</docs-alert>

1. 「ロリポップ！ユーザー専用ページ」にログインします
2. 画面左のメニューから「ユーザー設定」を選び、「アカウント情報」をクリックします
3. 「サーバー情報」にある「**FTPSサーバー**」「**FTP・WebDAVアカウント**」「**FTP・WebDAVパスワード**」を確認、メモします
    - 「FTP・WebDAVパスワード」は、「表示」ボタンを押すと確認できます。
4. FTPソフトでFTP接続します。FTPソフトをインストールしていない場合、Cyberduckがお勧めです。設定方法はロリポップ！レンタルサーバーのサポートページに掲載されています([Macの場合](https://lolipop.jp/manual/hp/m-cyberduck/) / [Windowsの場合](https://lolipop.jp/manual/hp/w-cyberduck/))。
    - Cyberduckの場合、「環境設定」内の「ブラウザ」タブにある「'.'で始まるファイルを表示」にチェックを入れてください
      ![Cyberduck 環境設定](/docs-images/cyberduck-settings-dotfile.png)
5. 初期状態では welcome.html というファイルが設置されています。不要なため、welcome.html を右クリックして削除します。
6. PortalDots.zip をダウンロードし、展開します。
7. 展開してできたフォルダの中身を全てアップロードします。Cyberduckの場合、Finder(macOSの場合)またはエクスプローラー(Windowsの場合)からファイルをドラッグ&ドロップしてください。
    - 隠しファイル(ドットで始まるファイル)も含めてアップロードしてください。macOS や Linux などの OS では、デフォルトではこれらのファイルは非表示になっています。macOS の場合、Finder で <docs-kbd>Command</docs-kbd> + <docs-kbd>Shift</docs-kbd> + <docs-kbd>.</docs-kbd> を押すと隠しファイルが表示されます。
        ![Cyberduck でファイルをアップロードする](/docs-images/cyberduck-drag-and-drop.png)
8. アップロードには5分〜10分程度時間がかかりますので、お待ちください。
9. アップロードが完了したら、ロリポップのユーザー専用ページ上部に表示されている「ロリポップ！のドメイン」のURLにアクセスします。この際、URLの先頭に「https://」をつけてアクセスしてください。
    - 「ロリポップ！のドメイン」が「 〇〇.capoo.jp 」の場合、「 https://〇〇.capoo.jp 」にアクセスしてください。
10. 「PortalDotsへようこそ！」という画面が表示されたら、アップロード完了です。

![「PortalDotsへようこそ！」画面](/docs-images/setup-installer-welcome.png)

## 5. PortalDotsのインストール作業を進める

「PortalDotsへようこそ！」画面にある「設定をはじめる」をクリックします。

### 5.1. 「ポータルの情報」設定

![「ポータルの情報」設定](/docs-images/setup-installer-step1.png)

「ポータルの情報」画面では、以下のように設定します。

- 「ポータルの名前」にはウェブシステムの名前を設定します。例えば「野田祭ウェブシステム」など、「〇〇祭ウェブシステム」という名前がお勧めです。
- 「ポータルのURL」には、ロリポップのユーザー専用ページ上部に表示されている「ロリポップ！のドメイン」の先頭に、「https://」を追加したものを入力してください。「ロリポップ！のドメイン」が「 〇〇.capoo.jp 」の場合、「ポータルのURL」には「 https://〇〇.capoo.jp 」と入力してください。
- 「https接続を強制する」にチェックを入れます。
- 「実行委員会の名称」には、学園祭実行委員会の名称を入力します。ここで入力された名前は、PortalDotsから送信されるメールの文面など、PortalDotsの画面上に表示されます。
- 「実行委員会のメールアドレス」には、学園祭参加企画からのお問い合わせを受け付けるメールアドレスを入力します。PortalDotsから送信された「お問い合わせ」はこのメールアドレスに届くほか、PortalDotsから送信されるメールの文面など、PortalDotsの画面上に表示されます。
- 「学校発行メールアドレスのドメイン」には、学校が学生に配布・発行しているメールアドレスの「@」より後の文字列を入力します。
    - PortalDotsは、学校から学生に対し発行されるメールアドレスの形式が「学籍番号@固定のドメイン」の場合のみ利用できます。
        - 例えば東京理科大学の場合は「固定のドメイン」が「ed.tus.ac.jp」となっており、利用可能です。「@」より前に任意の文字列を設定できる学校、または学生により「@」より後の文字列が異なる学校、「@」より前の文字列において、小文字・大文字の区別がある学校では PortalDotsは利用できません（将来的には、これらの学校でも利用できるようにする予定です）。

<docs-alert type="info">
  「@」より前に任意の文字列を設定できる学校でも、一応の利用は可能です。その場合、参加企画に対しては次のように説明してください : 「ウェブシステム上では『学籍番号』と表示されていますが、この入力欄には、学校発行メールアドレスの『@』より前の文字列を入力してください。」
</docs-alert>

### 5.2. 「MySQL データベース設定」

![「MySQL データベース設定」](/docs-images/setup-installer-step2.png)

「MySQL データベース設定」で「2. データベースを作成する」でメモした情報を入力します。

- 「データベースのホスト名」には、メモした「サーバー」を入力します。
- 「ポート番号」には、半角数字で「3306」を入力します。
- 「データベース名」には、メモした「データベース名」を入力します。
- 「ユーザー名」には、メモした「データベースユーザー名」を入力します。
- 「パスワード」には、メモした「データベースパスワード」を入力します。

### 5.3. 「メール配信設定」

![「メール配信設定」設定](/docs-images/setup-installer-step3.png)

1. 「メール配信設定」で「3. メールサーバーを確認する」でメモした情報を入力します。
    - 「メールサーバー(SMTP)のホスト」には、メモした「SMTP メールサーバー」**の先頭に「ssl://」をつけたもの**を入力します。
        - 「SMTP メールサーバー」が「smtp.lolipop.jp」の場合、「ssl://smtp.lolipop.jp」を入力してください。
    - 「メールサーバー(SMTP)のポート」には、メモしたポート番号(半角数字)を入力します。
    - 「メールユーザー名」には、メモした「メールアカウント」を入力します。
    - 「メールパスワード」には、メモした「メールパスワード」を入力します。
    - 「PortalDotsから配信されるメールの差出人メールアドレス」には、メモした「メールアドレス」を入力します。
    - 「PortalDotsから配信されるメールの差出人の名前」には任意の文字列を設定できます。ウェブシステムの名前や実行委員会の名前にするのがお勧めです。ここで設定した名前は、PortalDotsから送信されるメールをユーザーが確認する際、メールアプリの「差出人」欄に表示されます。
2. 「保存して次へ」をクリックすると、先ほど設定した「実行委員会のメールアドレス」に対してテストメールが送信されます。

### 5.4. 「管理者ユーザーの設定」

![「管理者ユーザーの設定」](/docs-images/setup-installer-step4.png)

1. 「管理者ユーザーの設定」で、PortalDotsの管理者ユーザーを作成します。あなた自身の情報を入力してください。
2. 「登録してインストール実行」をクリックすると、データベース上に PortalDots関連データの保存領域が作成され、管理者ユーザー情報がデータベース上に保存されます。
3. 「メール確認」ページが表示されます。「学校発行メールアドレス」と「連絡先メールアドレス」それぞれに1通ずつ確認メールが送信されます。それぞれのメールに記載されたURLにアクセスしてください。
    ![「メール確認」ページ」](/docs-images/setup-installer-done.png)
4. 2通のURLにアクセスしたら、インストール完了です！

## 6. メールの一斉配信機能のセットアップ(CRONの設定)

「お知らせ」をユーザー全員に一斉配信するためには、CRONの設定が必要です。

1. CyberduckでサーバーにFTP接続します
2. Cyberduckの画面上の cron フォルダをダブルクリックして開きます
3. `lolipop.sh.sample` というファイルを右クリックし、「名前の変更」をクリックします
4. 名前を入力できるようになったら、「`lolipop.sh.sample`」を「`lolipop.sh`」に変更し、Enterキーを押します
5. 「名前したファイルを移動しますか？」と表示されたら「名前を変更」をクリックします
6. 「`lolipop.sh`」を右クリックし、「エディタで編集」を選択し、表示されるプログラム名(メモ帳など)をクリックします。
7. ファイル内の「PortalDotsのフォルダ」と書かれている箇所を削除し、代わりに `/home/users/0/【ロリポップ！のドメイン】`と入力してください。入力できたらファイルを保存してください。自動的にサーバーへアップロードされます。
    - 「ロリポップ！のドメイン」が「 〇〇.capoo.jp 」の場合、「PortalDotsのフォルダ」と書かれている箇所を`/home/users/0/〇〇.capoo.jp` に変更してください。
8. `lolipop.sh` を右クリックし、「情報」をクリックします
9. 「アクセス権」タブを開き、「オーナー」という行にある「実行」にチェックを入れます。
    ![アクセス権設定](/docs-images/cyberduck-settings-file-permission.png)
10. 「ロリポップ！ユーザー専用ページ」にログインします
11. 画面左のメニューから「サーバーの管理・設定」を選び、「cron設定」をクリックします
12. 以下のように入力します。
    - 「cronの設定名」には「PortalDots」と入力します。
    - 「日付（月）」では「毎月」を選択します。
    - 「日付（日）」では「毎日」を選択します。
    - 「曜日」では「毎日」を選択します。
    - 「時間（時）」では「毎時」を選択します。
    - 「時間（分）」では「10分毎」を選択します。
13. 「スケジュール」欄に「10分毎 のスケジュールで実行します」と表示されたことを確認します。
14. 「実行ファイルパス」には「cron/lolipop.sh」と入力します。
15. 「設定」ボタンをクリックします。
16. 以上でCRON設定は完了です。「お知らせ」の一斉配信機能が利用可能になります。

## こんなときはどうする？

### インストール中にエラーが発生したとき

- 「MySQL データベース設定」や「メール配信設定」をしようとしてもエラーになる場合、入力したパスワードなどが間違っていないかご確認ください。
    - 「データベースパスワード」と「メールパスワード」は、通常異なるパスワードです。「データベースパスワード」を入力するべきところ「メールパスワード」を入力してしまっているなど、パスワードの入力に誤りがないかご確認ください。
- 「メール配信設定」にある「メールサーバー(SMTP)のホスト」の入力欄では、先頭に「ssl://」をつける必要があります。
- 「メール配信設定」にある「メールサーバー(SMTP)のホスト」の入力欄に入力したものが「SMTP メールサーバー」となっているかご確認ください。
    - ロリポップ！レンタルサーバーでは、「SMTP メールサーバー」の他に「POP メールサーバー」や「IMAP メールサーバー」があります。このうち、「POP メールサーバー」や「IMAP メールサーバー」の情報は PortalDotsのインストールに不要なものです。
